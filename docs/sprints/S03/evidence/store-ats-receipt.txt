$ npx tsx --test engine/templates/compiler.test.ts
TAP version 13
# Subtest: AT-S03-01: Compiler emits schema-valid ticket deterministically
ok 1 - AT-S03-01: Compiler emits schema-valid ticket deterministically
  ---
  duration_ms: 1.426166
  type: 'test'
  ...
# Subtest: AT-S03-02: Missing placeholder triggers "needs input" state deterministically
ok 2 - AT-S03-02: Missing placeholder triggers "needs input" state deterministically
  ---
  duration_ms: 0.987833
  type: 'test'
  ...
# Subtest: AT-S03-03: Template version pinning keeps older sprints stable
ok 3 - AT-S03-03: Template version pinning keeps older sprints stable
  ---
  duration_ms: 0.219084
  type: 'test'
  ...
# Subtest: S03.D Safety Diff test (Protected sections)
ok 4 - S03.D Safety Diff test (Protected sections)
  ---
  duration_ms: 0.206
  type: 'test'
  ...
# Subtest: AT-S03-04: JSON-safe placeholder injection with quotes and newlines
ok 5 - AT-S03-04: JSON-safe placeholder injection with quotes and newlines
  ---
  duration_ms: 0.157666
  type: 'test'
  ...
# Subtest: AT-S03-05: Safety enforcement on activation (with and without override)
ok 6 - AT-S03-05: Safety enforcement on activation (with and without override)
  ---
  duration_ms: 0.143125
  type: 'test'
  ...
1..6
# tests 6
# suites 0
# pass 6
# fail 0
# cancelled 0
# skipped 0
# todo 0
# duration_ms 118.815917
EXIT_CODE=0
